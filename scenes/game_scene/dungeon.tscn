[gd_scene load_steps=60 format=3 uid="uid://dy1uiy23nc5he"]

[ext_resource type="Texture2D" uid="uid://bhqas40v1sogj" path="res://assets/dungeon/dungeon_base.PNG" id="1_miufi"]
[ext_resource type="Texture2D" uid="uid://bt4kb5hqwg4nl" path="res://assets/dungeon/dungeon_border.PNG" id="2_5623h"]
[ext_resource type="Texture2D" uid="uid://bk68ku7102sx8" path="res://assets/dungeon/door/dungeon_door_open.PNG" id="3_7taji"]
[ext_resource type="Texture2D" uid="uid://bj3y7jkhwmfq0" path="res://assets/dungeon/originals/axe.PNG" id="3_5623h"]
[ext_resource type="Texture2D" uid="uid://byc5u5cn58hsi" path="res://assets/dungeon/door/dungeon_door_closed.PNG" id="4_7taji"]
[ext_resource type="Texture2D" uid="uid://cw2h6s26burpl" path="res://assets/dungeon/cross.PNG" id="4_mv2yw"]
[ext_resource type="Shader" uid="uid://cixrxdx4xtfdp" path="res://scripts/shaders/drop_shadow.gdshader" id="5_4somj"]
[ext_resource type="Texture2D" uid="uid://b7c4vqwdyf0mg" path="res://assets/dungeon/originals/axe_n.png" id="7_tkn77"]
[ext_resource type="Texture2D" uid="uid://cn8w7nj28gjup" path="res://assets/dungeon/dungeon_table.PNG" id="8_epj33"]
[ext_resource type="PackedScene" uid="uid://d1cmt6tktxlt3" path="res://scenes/game_scene/dungeon/chest_and_barrel.tscn" id="8_ikx5i"]
[ext_resource type="Texture2D" uid="uid://bwlvfdu4ps75o" path="res://assets/dungeon/originals/axe_s.png" id="8_uf2vu"]
[ext_resource type="Texture2D" uid="uid://5yym7638cog7" path="res://assets/dungeon/journal.PNG" id="9_hamwq"]
[ext_resource type="PackedScene" uid="uid://dmdlnr87n1wxl" path="res://spawn_system/mushroom/mushroom_field.tscn" id="9_tkn77"]
[ext_resource type="Texture2D" uid="uid://bq2vvs6x38nnm" path="res://assets/dungeon/originals/saw.PNG" id="10_4ovda"]
[ext_resource type="Texture2D" uid="uid://ci7rt38s0ry1r" path="res://assets/dungeon/torch.PNG" id="11_554xe"]
[ext_resource type="Script" uid="uid://cybwchfl8pj2v" path="res://scripts/flickering_light_2d.gd" id="13_ikx5i"]
[ext_resource type="PackedScene" uid="uid://31fnvnrufja0" path="res://crush_system/wood_chipper.tscn" id="14_0sevn"]
[ext_resource type="Texture2D" uid="uid://dwr0060psd8kh" path="res://assets/dungeon/prison/prison_bottom.PNG" id="15_7taji"]
[ext_resource type="Texture2D" uid="uid://df5m0n2gb7q36" path="res://assets/dungeon/prison/prison_top.PNG" id="16_0sevn"]
[ext_resource type="Script" uid="uid://cfc8a16cgd5gl" path="res://scenes/game_scene/scripts/interactable_shop.gd" id="17_7taji"]
[ext_resource type="PackedScene" uid="uid://wgvolemsb07q" path="res://scenes/game_scene/dungeon/basement_floors.tscn" id="18_0sevn"]
[ext_resource type="Script" uid="uid://bwtta7g7ucgg2" path="res://spawn_system/corpse_spawn_system.gd" id="20_j3unq"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ikx5i"]
size = Vector2(200, 20)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_4somj"]
size = Vector2(200, 20)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_tkn77"]
size = Vector2(20, 100)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_uf2vu"]
size = Vector2(20, 100)

[sub_resource type="SpriteFrames" id="SpriteFrames_4somj"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": ExtResource("3_7taji")
}, {
"duration": 1.0,
"texture": ExtResource("4_7taji")
}],
"loop": false,
"name": &"close",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("4_7taji")
}],
"loop": true,
"name": &"closed",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": ExtResource("4_7taji")
}, {
"duration": 1.0,
"texture": ExtResource("3_7taji")
}],
"loop": false,
"name": &"open",
"speed": 5.0
}]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_tkn77"]
shader = ExtResource("5_4somj")
shader_parameter/debug = false
shader_parameter/border_scale = 2.0
shader_parameter/shadow_offset = Vector2(0, -1)
shader_parameter/color = Color(0.051971, 0.051971, 0.051971, 1)
shader_parameter/blur_amount = 1.0
shader_parameter/shadow_scale = 1.5
shader_parameter/disable_rotating = false

[sub_resource type="CanvasTexture" id="CanvasTexture_j3unq"]
diffuse_texture = ExtResource("3_5623h")
normal_texture = ExtResource("7_tkn77")
specular_texture = ExtResource("8_uf2vu")
specular_shininess = 0.0

[sub_resource type="ShaderMaterial" id="ShaderMaterial_4somj"]
shader = ExtResource("5_4somj")
shader_parameter/debug = false
shader_parameter/border_scale = 2.0
shader_parameter/shadow_offset = Vector2(1, -1)
shader_parameter/color = Color(0.0728426, 0.0728426, 0.0728426, 1)
shader_parameter/blur_amount = 1.0
shader_parameter/shadow_scale = 1.5
shader_parameter/disable_rotating = false

[sub_resource type="ShaderMaterial" id="ShaderMaterial_tbl2k"]
shader = ExtResource("5_4somj")
shader_parameter/debug = false
shader_parameter/border_scale = 2.0
shader_parameter/shadow_offset = Vector2(-1, 1)
shader_parameter/color = Color(0, 0, 0, 1)
shader_parameter/blur_amount = 1.0
shader_parameter/shadow_scale = 1.5
shader_parameter/disable_rotating = false

[sub_resource type="RectangleShape2D" id="RectangleShape2D_h67ak"]
size = Vector2(17.5, 28)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ppaq7"]
shader = ExtResource("5_4somj")
shader_parameter/debug = false
shader_parameter/border_scale = 2.0
shader_parameter/shadow_offset = Vector2(1, -1)
shader_parameter/color = Color(0, 0, 0, 1)
shader_parameter/blur_amount = 1.0
shader_parameter/shadow_scale = 1.5
shader_parameter/disable_rotating = false

[sub_resource type="ShaderMaterial" id="ShaderMaterial_nnpvd"]
shader = ExtResource("5_4somj")
shader_parameter/debug = false
shader_parameter/border_scale = 2.0
shader_parameter/shadow_offset = Vector2(0, -1)
shader_parameter/color = Color(0, 0, 0, 1)
shader_parameter/blur_amount = 0.0
shader_parameter/shadow_scale = 1.5
shader_parameter/disable_rotating = false

[sub_resource type="Gradient" id="Gradient_2bcuf"]
colors = PackedColorArray(1, 1, 1, 1, 0, 0, 0, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_004c8"]
gradient = SubResource("Gradient_2bcuf")
fill = 1
fill_from = Vector2(0.5, 0.09)

[sub_resource type="FastNoiseLite" id="FastNoiseLite_ikx5i"]
noise_type = 3
frequency = 0.0607

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_4somj"]
noise = SubResource("FastNoiseLite_ikx5i")
seamless = true

[sub_resource type="ShaderMaterial" id="ShaderMaterial_1ek56"]
shader = ExtResource("5_4somj")
shader_parameter/debug = false
shader_parameter/border_scale = 2.0
shader_parameter/shadow_offset = Vector2(0, -1)
shader_parameter/color = Color(0, 0, 0, 1)
shader_parameter/blur_amount = 0.0
shader_parameter/shadow_scale = 1.5
shader_parameter/disable_rotating = false

[sub_resource type="FastNoiseLite" id="FastNoiseLite_4somj"]
noise_type = 3
seed = 1
frequency = 0.0607

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_tkn77"]
noise = SubResource("FastNoiseLite_4somj")
seamless = true

[sub_resource type="ShaderMaterial" id="ShaderMaterial_dcphp"]
shader = ExtResource("5_4somj")
shader_parameter/debug = false
shader_parameter/border_scale = 2.0
shader_parameter/shadow_offset = Vector2(0, -1)
shader_parameter/color = Color(0, 0, 0, 1)
shader_parameter/blur_amount = 0.0
shader_parameter/shadow_scale = 1.5
shader_parameter/disable_rotating = false

[sub_resource type="FastNoiseLite" id="FastNoiseLite_tkn77"]
noise_type = 3
seed = 2
frequency = 0.0607

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_uf2vu"]
noise = SubResource("FastNoiseLite_tkn77")
seamless = true

[sub_resource type="ShaderMaterial" id="ShaderMaterial_lcf54"]
shader = ExtResource("5_4somj")
shader_parameter/debug = false
shader_parameter/border_scale = 2.0
shader_parameter/shadow_offset = Vector2(0, -1)
shader_parameter/color = Color(0, 0, 0, 1)
shader_parameter/blur_amount = 0.0
shader_parameter/shadow_scale = 1.5
shader_parameter/disable_rotating = false

[sub_resource type="FastNoiseLite" id="FastNoiseLite_j3unq"]
noise_type = 3
seed = 4
frequency = 0.0607

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_ppaq7"]
noise = SubResource("FastNoiseLite_j3unq")
seamless = true

[sub_resource type="FastNoiseLite" id="FastNoiseLite_uf2vu"]
noise_type = 3
seed = 5
frequency = 0.0607

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_j3unq"]
noise = SubResource("FastNoiseLite_uf2vu")
seamless = true

[sub_resource type="FastNoiseLite" id="FastNoiseLite_ppaq7"]
noise_type = 3
seed = 6
frequency = 0.0607

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_cj0f8"]
noise = SubResource("FastNoiseLite_ppaq7")
seamless = true

[sub_resource type="FastNoiseLite" id="FastNoiseLite_cj0f8"]
noise_type = 3
seed = 7
frequency = 0.0607

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_0ja0t"]
noise = SubResource("FastNoiseLite_cj0f8")
seamless = true

[sub_resource type="FastNoiseLite" id="FastNoiseLite_0ja0t"]
noise_type = 3
seed = 8
frequency = 0.0607

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_tbl2k"]
noise = SubResource("FastNoiseLite_0ja0t")
seamless = true

[sub_resource type="ShaderMaterial" id="ShaderMaterial_cj0f8"]
shader = ExtResource("5_4somj")
shader_parameter/debug = false
shader_parameter/border_scale = 2.0
shader_parameter/shadow_offset = Vector2(0, -1)
shader_parameter/color = Color(0, 0, 0, 1)
shader_parameter/blur_amount = 1.0
shader_parameter/shadow_scale = 1.5
shader_parameter/disable_rotating = false

[sub_resource type="ShaderMaterial" id="ShaderMaterial_0ja0t"]
shader = ExtResource("5_4somj")
shader_parameter/debug = false
shader_parameter/border_scale = 2.0
shader_parameter/shadow_offset = Vector2(0, -1)
shader_parameter/color = Color(0, 0, 0, 1)
shader_parameter/blur_amount = 1.0
shader_parameter/shadow_scale = 1.5
shader_parameter/disable_rotating = false

[sub_resource type="RectangleShape2D" id="RectangleShape2D_6kpy7"]
size = Vector2(39, 24)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_j3unq"]
size = Vector2(19, 10)

[node name="Dungeon" type="Node2D"]

[node name="dungeon_base" type="Sprite2D" parent="."]
z_index = -10
z_as_relative = false
texture = ExtResource("1_miufi")

[node name="dungeon_border" type="Sprite2D" parent="dungeon_base"]
z_index = 10
z_as_relative = false
texture = ExtResource("2_5623h")

[node name="dungeon_collision_border" type="StaticBody2D" parent="dungeon_base"]
visible = false

[node name="dungeon_bottom" type="CollisionShape2D" parent="dungeon_base/dungeon_collision_border"]
position = Vector2(0, 55)
shape = SubResource("RectangleShape2D_ikx5i")

[node name="dungeon_top" type="CollisionShape2D" parent="dungeon_base/dungeon_collision_border"]
position = Vector2(0, -45)
rotation = 3.14159
shape = SubResource("RectangleShape2D_4somj")

[node name="dungeon_left" type="CollisionShape2D" parent="dungeon_base/dungeon_collision_border"]
position = Vector2(-90, 0)
shape = SubResource("RectangleShape2D_tkn77")

[node name="dungeon_right" type="CollisionShape2D" parent="dungeon_base/dungeon_collision_border"]
position = Vector2(92, 0)
shape = SubResource("RectangleShape2D_uf2vu")

[node name="dungeon_door" type="AnimatedSprite2D" parent="dungeon_base"]
position = Vector2(-37.5, -41)
sprite_frames = SubResource("SpriteFrames_4somj")
animation = &"open"

[node name="axe" type="Sprite2D" parent="dungeon_base"]
z_index = -5
z_as_relative = false
material = SubResource("ShaderMaterial_tkn77")
position = Vector2(1, -38)
texture = SubResource("CanvasTexture_j3unq")

[node name="cross" type="Sprite2D" parent="dungeon_base"]
z_index = -5
z_as_relative = false
material = SubResource("ShaderMaterial_4somj")
position = Vector2(17, -41.5)
texture = ExtResource("4_mv2yw")

[node name="chest_and_barrel" parent="dungeon_base" instance=ExtResource("8_ikx5i")]
position = Vector2(-72, -36)

[node name="dungeon_table" type="Sprite2D" parent="dungeon_base"]
z_index = 5
z_as_relative = false
material = SubResource("ShaderMaterial_tbl2k")
position = Vector2(72, 29)
texture = ExtResource("8_epj33")

[node name="table_body" type="StaticBody2D" parent="dungeon_base/dungeon_table"]
visible = false

[node name="table_collision" type="CollisionShape2D" parent="dungeon_base/dungeon_table/table_body"]
position = Vector2(1.25, 0.5)
shape = SubResource("RectangleShape2D_h67ak")

[node name="journal" type="Sprite2D" parent="dungeon_base"]
z_index = 7
z_as_relative = false
position = Vector2(73.5, 32.5)
texture = ExtResource("9_hamwq")

[node name="saw" type="Sprite2D" parent="dungeon_base"]
z_index = -5
z_as_relative = false
material = SubResource("ShaderMaterial_ppaq7")
position = Vector2(66.5, -45.5)
texture = ExtResource("10_4ovda")

[node name="Lights" type="Node2D" parent="dungeon_base"]

[node name="Upper" type="Node2D" parent="dungeon_base/Lights"]

[node name="torch_1" type="Sprite2D" parent="dungeon_base/Lights/Upper"]
z_index = -5
z_as_relative = false
material = SubResource("ShaderMaterial_nnpvd")
position = Vector2(-64, -46)
texture = ExtResource("11_554xe")

[node name="PointLight2D" type="PointLight2D" parent="dungeon_base/Lights/Upper/torch_1"]
position = Vector2(0, 23.5)
color = Color(0.905882, 0, 1, 1)
range_z_max = 9
texture = SubResource("GradientTexture2D_004c8")
height = 20.0
script = ExtResource("13_ikx5i")
noise = SubResource("NoiseTexture2D_4somj")

[node name="torch_2" type="Sprite2D" parent="dungeon_base/Lights/Upper"]
z_index = -5
z_as_relative = false
material = SubResource("ShaderMaterial_1ek56")
position = Vector2(-17, -46)
texture = ExtResource("11_554xe")

[node name="PointLight2D" type="PointLight2D" parent="dungeon_base/Lights/Upper/torch_2"]
position = Vector2(0, 23.5)
color = Color(0.905882, 0, 1, 1)
range_z_max = 9
texture = SubResource("GradientTexture2D_004c8")
height = 20.0
script = ExtResource("13_ikx5i")
noise = SubResource("NoiseTexture2D_tkn77")
sample_scale = 3.0
speed = 2.0

[node name="torch_3" type="Sprite2D" parent="dungeon_base/Lights/Upper"]
z_index = -5
z_as_relative = false
material = SubResource("ShaderMaterial_dcphp")
position = Vector2(31, -46)
texture = ExtResource("11_554xe")

[node name="PointLight2D" type="PointLight2D" parent="dungeon_base/Lights/Upper/torch_3"]
position = Vector2(0, 23.5)
color = Color(0.905882, 0, 1, 1)
range_z_max = 9
texture = SubResource("GradientTexture2D_004c8")
height = 20.0
script = ExtResource("13_ikx5i")
noise = SubResource("NoiseTexture2D_uf2vu")
sample_scale = 3.0
speed = 2.0

[node name="torch_4" type="Sprite2D" parent="dungeon_base/Lights/Upper"]
z_index = -5
z_as_relative = false
material = SubResource("ShaderMaterial_lcf54")
position = Vector2(78, -46)
texture = ExtResource("11_554xe")

[node name="PointLight2D" type="PointLight2D" parent="dungeon_base/Lights/Upper/torch_4"]
position = Vector2(0, 23.5)
color = Color(0.905882, 0, 1, 1)
range_z_max = 9
texture = SubResource("GradientTexture2D_004c8")
height = 20.0
script = ExtResource("13_ikx5i")
noise = SubResource("NoiseTexture2D_ppaq7")
sample_scale = 3.0
speed = 2.0

[node name="Lower" type="Node2D" parent="dungeon_base/Lights"]
position = Vector2(0, 37)
rotation = 3.14159

[node name="PointLight2D" type="PointLight2D" parent="dungeon_base/Lights/Lower"]
position = Vector2(64, 23)
color = Color(0.905882, 0, 1, 1)
range_z_max = 9
texture = SubResource("GradientTexture2D_004c8")
height = 20.0
script = ExtResource("13_ikx5i")
noise = SubResource("NoiseTexture2D_j3unq")
sample_scale = 3.0
speed = 2.0

[node name="PointLight2D2" type="PointLight2D" parent="dungeon_base/Lights/Lower"]
position = Vector2(16, 23)
color = Color(0.905882, 0, 1, 1)
range_z_max = 9
texture = SubResource("GradientTexture2D_004c8")
height = 20.0
script = ExtResource("13_ikx5i")
noise = SubResource("NoiseTexture2D_cj0f8")
sample_scale = 3.0
speed = 2.0

[node name="PointLight2D3" type="PointLight2D" parent="dungeon_base/Lights/Lower"]
position = Vector2(-30, 23)
color = Color(0.905882, 0, 1, 1)
range_z_max = 9
texture = SubResource("GradientTexture2D_004c8")
height = 20.0
script = ExtResource("13_ikx5i")
noise = SubResource("NoiseTexture2D_0ja0t")
sample_scale = 3.0
speed = 2.0

[node name="PointLight2D4" type="PointLight2D" parent="dungeon_base/Lights/Lower"]
position = Vector2(-78, 23)
color = Color(0.905882, 0, 1, 1)
range_z_max = 9
texture = SubResource("GradientTexture2D_004c8")
height = 20.0
script = ExtResource("13_ikx5i")
noise = SubResource("NoiseTexture2D_tbl2k")
sample_scale = 3.0
speed = 2.0

[node name="wood_chipper" parent="dungeon_base" instance=ExtResource("14_0sevn")]
position = Vector2(24.5, 22)

[node name="prison" type="Node2D" parent="dungeon_base"]
z_index = -5
z_as_relative = false
position = Vector2(41, -15)

[node name="prison_bottom" type="Sprite2D" parent="dungeon_base/prison"]
z_index = -5
z_as_relative = false
material = SubResource("ShaderMaterial_cj0f8")
position = Vector2(0.5, 0.5)
texture = ExtResource("15_7taji")

[node name="prison_top" type="Sprite2D" parent="dungeon_base/prison"]
z_index = 5
z_as_relative = false
material = SubResource("ShaderMaterial_0ja0t")
position = Vector2(0.5, -10.5)
texture = ExtResource("16_0sevn")

[node name="prison_body" type="StaticBody2D" parent="dungeon_base/prison"]
visible = false

[node name="prison_shape" type="CollisionShape2D" parent="dungeon_base/prison/prison_body"]
position = Vector2(0.5, 3)
shape = SubResource("RectangleShape2D_6kpy7")

[node name="interactable_shop" type="Area2D" parent="."]
position = Vector2(-38, -35)
script = ExtResource("17_7taji")
interact_prompt = "Interact Door"
metadata/_custom_type_script = "uid://b1kccbwcfiryn"

[node name="collision_interactable_basement" type="CollisionShape2D" parent="interactable_shop"]
position = Vector2(0.5, 5)
shape = SubResource("RectangleShape2D_j3unq")

[node name="BasementFloors" parent="." instance=ExtResource("18_0sevn")]
visible = false

[node name="corpse_spawner" type="Node2D" parent="."]
position = Vector2(41, -15)
script = ExtResource("20_j3unq")

[node name="mushroom_field" parent="." instance=ExtResource("9_tkn77")]
position = Vector2(-47.5, 13.5)

[connection signal="player_interacted" from="interactable_shop" to="interactable_shop" method="_on_player_interacted"]
